@model HRApp.Models.ProfileViewModel

@{
    ViewData["Title"] = "Profile";
}

<h2>Profile</h2>

@if (ViewBag.Message != null)
{
    <div class="alert alert-success">
        @ViewBag.Message
    </div>
}

<form asp-action="Index" method="post">
    <div class="form-group">
        <label asp-for="Birthdate"></label>
        <input asp-for="Birthdate" class="form-control" />
        <span asp-validation-for="Birthdate" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Address"></label>
        <input asp-for="Address" class="form-control" />
        <span asp-validation-for="Address" class="text-danger"></span>
    </div>
    <div class="form-group">
        <label asp-for="Position"></label>
        <input asp-for="Position" class="form-control" />
        <span asp-validation-for="Position" class="text-danger"></span>
    </div>

    <h3>Education</h3>
    <div id="education-section">
        @for (int i = 0; i < Model.Educations.Count; i++)
        {
            <div class="education-group" data-index="@i">
                <div class="form-group">
                    <label asp-for="@Model.Educations[i].School"></label>
                    <input asp-for="@Model.Educations[i].School" class="form-control" />
                    <span asp-validation-for="@Model.Educations[i].School" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Educations[i].Degree"></label>
                    <input asp-for="@Model.Educations[i].Degree" class="form-control" />
                    <span asp-validation-for="@Model.Educations[i].Degree" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Educations[i].FieldOfStudy"></label>
                    <input asp-for="@Model.Educations[i].FieldOfStudy" class="form-control" />
                    <span asp-validation-for="@Model.Educations[i].FieldOfStudy" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Educations[i].StartDate"></label>
                    <input asp-for="@Model.Educations[i].StartDate" class="form-control" />
                    <span asp-validation-for="@Model.Educations[i].StartDate" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Educations[i].EndDate"></label>
                    <input asp-for="@Model.Educations[i].EndDate" class="form-control" />
                    <span asp-validation-for="@Model.Educations[i].EndDate" class="text-danger"></span>
                </div>
                <button type="button" class="btn btn-danger remove-education">Remove</button>
            </div>
        }
    </div>
    <a asp-action="AddEducation" class="btn btn-primary">Add Education</a>

    <h3>Experience</h3>
    <div id="experience-section">
        @for (int i = 0; i < Model.Experiences.Count; i++)
        {
            <div class="experience-group" data-index="@i">
                <div class="form-group">
                    <label asp-for="@Model.Experiences[i].CompanyName"></label>
                    <input asp-for="@Model.Experiences[i].CompanyName" class="form-control" />
                    <span asp-validation-for="@Model.Experiences[i].CompanyName" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Experiences[i].Position"></label>
                    <input asp-for="@Model.Experiences[i].Position" class="form-control" />
                    <span asp-validation-for="@Model.Experiences[i].Position" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Experiences[i].Description"></label>
                    <input asp-for="@Model.Experiences[i].Description" class="form-control" />
                    <span asp-validation-for="@Model.Experiences[i].Description" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Experiences[i].StartDate"></label>
                    <input asp-for="@Model.Experiences[i].StartDate" class="form-control" />
                    <span asp-validation-for="@Model.Experiences[i].StartDate" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Experiences[i].EndDate"></label>
                    <input asp-for="@Model.Experiences[i].EndDate" class="form-control" />
                    <span asp-validation-for="@Model.Experiences[i].EndDate" class="text-danger"></span>
                </div>
                <button type="button" class="btn btn-danger remove-experience">Remove</button>
            </div>
        }
    </div>
    <a asp-action="AddExperience" class="btn btn-primary">Add Experience</a>

    <h3>Certifications</h3>
    <div id="certification-section">
        @for (int i = 0; i < Model.Certifications.Count; i++)
        {
            <div class="certification-group" data-index="@i">
                <div class="form-group">
                    <label asp-for="@Model.Certifications[i].CertificationName"></label>
                    <input asp-for="@Model.Certifications[i].CertificationName" class="form-control" />
                    <span asp-validation-for="@Model.Certifications[i].CertificationName" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Certifications[i].CertificationProvider"></label>
                    <input asp-for="@Model.Certifications[i].CertificationProvider" class="form-control" />
                    <span asp-validation-for="@Model.Certifications[i].CertificationProvider" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Certifications[i].QualificationId"></label>
                    <input asp-for="@Model.Certifications[i].QualificationId" class="form-control" />
                    <span asp-validation-for="@Model.Certifications[i].QualificationId" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="@Model.Certifications[i].CertificationDate"></label>
                    <input asp-for="@Model.Certifications[i].CertificationDate" class="form-control" />
                    <span asp-validation-for="@Model.Certifications[i].CertificationDate" class="text-danger"></span>
                </div>
                <button type="button" class="btn btn-danger remove-certification">Remove</button>
            </div>
        }
    </div>
    <a asp-action="AddCertification" class="btn btn-primary">Add Certification</a>

    <button type="submit" class="btn btn-success">Save</button>
</form>

@section Scripts {
    <script>
        function attachRemoveEvent() {
            var removeEducationButtons = document.querySelectorAll('.remove-education');
            removeEducationButtons.forEach(function (button) {
                button.removeEventListener('click', removeEducation);
                button.addEventListener('click', removeEducation);
            });

            var removeExperienceButtons = document.querySelectorAll('.remove-experience');
            removeExperienceButtons.forEach(function (button) {
                button.removeEventListener('click', removeExperience);
                button.addEventListener('click', removeExperience);
            });

            var removeCertificationButtons = document.querySelectorAll('.remove-certification');
            removeCertificationButtons.forEach(function (button) {
                button.removeEventListener('click', removeCertification);
                button.addEventListener('click', removeCertification);
            });
        }

        function removeEducation(event) {
            var educationGroup = event.target.closest('.education-group');
            educationGroup.remove();
        }

        function removeExperience(event) {
            var experienceGroup = event.target.closest('.experience-group');
            experienceGroup.remove();
        }

        function removeCertification(event) {
            var certificationGroup = event.target.closest('.certification-group');
            certificationGroup.remove();
        }

        // Initial call to attach remove event to existing elements
        attachRemoveEvent();
    </script>
}
