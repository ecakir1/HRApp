@model HRApp.Models.EducationViewModel

@{
    ViewData["Title"] = "Education";
}

<h2>Education</h2>

<form asp-action="AddEducation" method="post">
    <div id="education-section">
        <div class="education-group">
            <div class="form-group">
                <label asp-for="School"></label>
                <input asp-for="School" class="form-control" />
                <span asp-validation-for="School" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="Degree"></label>
                <input asp-for="Degree" class="form-control" />
                <span asp-validation-for="Degree" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="FieldOfStudy"></label>
                <input asp-for="FieldOfStudy" class="form-control" />
                <span asp-validation-for="FieldOfStudy" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="StartDate"></label>
                <input asp-for="StartDate" type="date" class="form-control" />
                <span asp-validation-for="StartDate" class="text-danger"></span>
            </div>
            <div class="form-group">
                <label asp-for="EndDate"></label>
                <input asp-for="EndDate" type="date" class="form-control" />
                <span asp-validation-for="EndDate" class="text-danger"></span>
            </div>
            <button type="button" class="btn btn-danger remove-education">Remove</button>
        </div>
    </div>
    <button type="button" id="add-education" class="btn btn-primary">Add Education</button>
    <button type="submit" class="btn btn-success">Save</button>
</form>

<a asp-action="Index" class="btn btn-secondary">Back to Profile</a>

@section Scripts {
    <script>
        document.getElementById('add-education').addEventListener('click', function () {
            var educationSection = document.getElementById('education-section');
            var index = educationSection.children.length; // Each education group has 1 input field
            var newEducation = `
                        <div class="education-group">
                            <div class="form-group">
                                <label for="Educations_${index}__School">School</label>
                                <input class="form-control" type="text" id="Educations_${index}__School" name="Educations[${index}].School" />
                            </div>
                            <div class="form-group">
                                <label for="Educations_${index}__Degree">Degree</label>
                                <input class="form-control" type="text" id="Educations_${index}__Degree" name="Educations[${index}].Degree" />
                            </div>
                            <div class="form-group">
                                <label for="Educations_${index}__FieldOfStudy">Field Of Study</label>
                                <input class="form-control" type="text" id="Educations_${index}__FieldOfStudy" name="Educations[${index}].FieldOfStudy" />
                            </div>
                            <div class="form-group">
                                <label for="Educations_${index}__StartDate">Start Date</label>
                                <input class="form-control" type="date" id="Educations_${index}__StartDate" name="Educations[${index}].StartDate" />
                            </div>
                            <div class="form-group">
                                <label for="Educations_${index}__EndDate">End Date</label>
                                <input class="form-control" type="date" id="Educations_${index}__EndDate" name="Educations[${index}].EndDate" />
                            </div>
                            <button type="button" class="btn btn-danger remove-education">Remove</button>
                        </div>
                    `;
            educationSection.insertAdjacentHTML('beforeend', newEducation);
            attachRemoveEvent();
        });

        function attachRemoveEvent() {
            var removeButtons = document.querySelectorAll('.remove-education');
            removeButtons.forEach(function (button) {
                button.removeEventListener('click', removeEducation);
                button.addEventListener('click', removeEducation);
            });
        }

        function removeEducation(event) {
            var educationGroup = event.target.closest('.education-group');
            educationGroup.remove();
        }

        // Initial call to attach remove event to existing elements
        attachRemoveEvent();
    </script>
}
